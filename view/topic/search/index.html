{% extends "../inc/base.html" %}
{% block content %}
{%set cate = category.id|get_cate()%}
<style type="text/css">
    .home-search-bar{
    	position: absolute; 
    	left: 50%; 
    	bottom: 40px; 
    	width: 414px; 
    	z-index: 100; 
    	margin-left: -207px;
    }
    section#slider input{
        background-color: #fff;
    }
    .ctr{
    	width: 984px; 
    	height: auto;
    	margin-top:0px; 
    	padding: 0px;
    	background-color: #fff;
    }
    .cgy{
        margin-top:15px;
    }
    .cgy a:focus:not(.btn) {
    color: #fff;
    }
    .phb{
    	padding:0px;
    	margin:0px auto ! important;
    	width:984px;
    	height:85px;
    	font-size: 25px;
    	color: #fff;
    	background: url('/static/assets/images/search_nav.png') no-repeat; 	
    }
    .phb li{
    	width: 25%;
    	height: 85px;
    	margin-right:-7px;
    	padding:0px;
    	text-align: center;
    }
    .phb li a{
        margin-top: 10px;
        width: 180px;
    	color: #fff;
    }
    .phb:hover{
        cursor: pointer;

    }
    .phb li:hover div{
        background-color: #fff !important;
    }
    .linea{
    	height: 3px;
    	width: 100%;
    	background-color: #896B63;
    	margin:0px auto;
    }
    table .btn{
    	margin: 0 0px!important;
    }
    .table>tbody>tr>td{
        padding: 5px;
        border-top: 0px solid #ddd;
    }
    .page-header ul.page-header-tabs>li>a{
    	color: #fff;
    }
    .tct{
    	width: 904px;
    	padding: 0; 
    	margin: 20px auto;
    }
    .bpm{
        width:904px;
        height: 150px;
        border-bottom: 0px;
        margin-bottom: 25px;
    }
    .bpm:hover {
    	cursor:pointer;
    	box-shadow: 0  5px 15px 5px rgba(0,0,0,0.1);
    }
    .blog-post-item h2{
    	margin-bottom:10px;
    } 
    .strategy-content{
    	width: 904px;
    	height: 150px;
    	margin-bottom: 20px;
    }
    .strategy-content:hover{
    	cursor: pointer;
    	box-shadow: 0  5px 15px 5px rgba(0,0,0,0.1);

    }
    .strategy-content:hover h2{
    	color: #1eb6c1;

    }
    /* .strategy-content:hover {
    	cursor: pointer;
    	box-shadow: 0  5px 15px 5px rgba(0,0,0,0.1);

    } */
    .strategy a{
        color:#565656;
    }
    .qsn-awr a{
        color:#565656;
    }
    .strategy-content>img{
    	float: left;
    	width: 233px;
    	height: 150px;
    }
    .strategy-txt{
    	margin-left: 274px;
    }
    .strategy-txt h2{
    	font-size:16px;
        font-weight: 500;
    	color: #121212;
    	margin: 0px 0px 10px 0px;
    }
    .strategy-txt p{
    	text-indent:1em;
    }
    .btn-danger {
        color: #fff;
        background-color: #1eb6c1;
        border-color: #1eb6c1;
    }
    .btn-danger:hover {
        color: #fff;
        background-color: #1eb6c1;
        border-color: #1eb6c1;
    }
    .btn-danger.focus, .btn-danger:focus {
        color: #fff;
        background-color: #1eb6c1;
        border-color: #1eb6c1;
    }
    .btn-danger:active:focus{
    	color: #fff;
        background-color: #1eb6c1;
        border-color: #1eb6c1;
    }
    .btn-danger:active:hover{
    	color: #fff;
        background-color: #1eb6c1;
        border-color: #1eb6c1;
    }
    .btn-danger.active, .btn-danger:active, .open>.dropdown-toggle.btn-danger {
        color: #fff;
        background-color: #1eb6c1;
        border-color: #1eb6c1;
    }
    .head-section{
        width:100%;
        height: 560px;
        /*background-position: center center;*/
        background:url(/static/assets/images/slider_search.jpg) 50% 50% / cover no-repeat;
    }
    .searchin{
        border: 10px solid rgba(26,21,31,0.5);
    }
    .body-section{
        background-color: #EFF7F9;
    }
    .peanut-roll{
        width:100%;
        height:143px;
        padding:0; 
        border-bottom:none;
        background: url(static/assets/images/home_logo1.jpg);
    }
    #page1{
        width: 904px;
        min-height:400px;
        margin: 0px auto;
        padding: 0px;
        display: none;
    }
    #page2{
        width: 984px;
        margin: 0px auto;
        margin-top:-15px;
        padding: 0px;
    }
    #page3{
        width: 904px;
        min-height: 400px;
        margin: 0px auto;
        padding: 0px;
        display: none;
    }
    #page4{
        width: 904px;
        min-height:400px;
        margin: 0px auto;
        padding: 0px;
        display: none;
    }
    .the-td{
        width: 90px;
        text-align:justify;
        text-align-last:justify;line-height:1.6;
    }
    .txtbd{
        width: 924px; 
        margin:10px -35px;
    }
    .left-part{
        margin-right: 25px;
        margin-left: 25px;
        width: 904px;
        height: auto;
    }
    .left-part h2:hover{
    	color: #1eb6c1;
    }
    .left-part p{
    	color: #3e3e3e;
    }
    .a-img{
        width:233px !important;
        height: 150px;
        max-width:none;
    }
    .bilt{
        padding-left:274px !important;
        height: 150px;
    }
    .bpm:hover .bilt>h2>a{
    	color: #1eb6c1;
    }
    .bilt p{
        text-indent:1em;
    }
    .gopage{
        width:100%;
        margin-top:10px;
    }
    .price-span{
        color:#1eb6c1;
        position: absolute;
        right: 15px;
    }
    .load-more,.tq-load-more,.tn-load-more,.no-more{
        margin-top: 10px;
        margin-bottom: 30px;
    }
    .load-more a{
        text-decoration-color: #8a8e9f;
        font-size: 18;
        color: #3e3e3e;
    }
    .no-more p{
        text-decoration-color: #8a8e9f;
        font-size: 12;
    } 
    .tournote_pagination a, a:focus:not(.btn){
    	color:#3e3e3e;
    }
    ul.blog-post-info {
    height: 33px;
    }
    section.page-header span.font-lato {
        border: 0px;
    }
    ul.blog-post-info li a:after {
        content:none;
    }
    ul.blog-post-info li {
        margin-right: 0px;
    }
    .span_userName{
        margin: 0px 6px;
        font-weight: bold;
    }
    .showquestion{
        border:#eee 1px solid;
        padding:15px 20px;
        margin-bottom:20px;
        width:862px;
    }
    .showquestion:hover h2 a{
        color: #1eb6c1;
    }
    .tourschool_pagination>a{
		color: #3e3e3e;
    }
</style>
    <!--
    PAGE HEADER

    CLASSES:
    .page-header-xs = 20px margins
    .page-header-md = 50px margins
    .page-header-lg = 80px margins
    .page-header-xlg= 130px margins
    .dark           = dark page header

    .shadow-before-1    = shadow 1 header top
    .shadow-after-1     = shadow 1 header bottom
    .shadow-before-2    = shadow 2 header top
    .shadow-after-2     = shadow 2 header bottom
    .shadow-before-3    = shadow 3 header top
    .shadow-after-3     = shadow 3 header bottom
    -->
    <!-- SLIDER -->
    <section id="slider" class="head-section" >
        <span class="overlay dark-2"><!-- dark overlay [0 to 9 opacity] --></span>

        <div class="display-table">
            <div class="display-table-cell vertical-align-middle">

                <!-- REVOLUTION SLIDER -->
                <div class="slider fullwidthbanner-container roundedcorners margin-bottom-30">
                    <div class="fullwidthbanner" data-height="560" data-shadow="3" data-navigationStyle="">
                        <ul class="">
                            <!-- SLIDE  -->
                            <li data-transition="fade" data-slotamount="7" data-masterspeed="300"  data-saveperformance="off" >
                            {#
                                <img src="/static/assets/images/slider_search.jpg" data-lazyload="/static/assets/images/slider_search.jpg" alt="" data-bgfit="cover" data-bgposition="center center" data-bgrepeat="no-repeat" />
                            #}    
                            

                            </li>
                            
                        </ul>
                        <div class="tp-bannertimer"><!-- progress bar --></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="home-search-bar">
            <!-- INLINE SEARCH -->
            <div class="searchin inline-search clearfix" >
                <form action="/search" method="get" class="widget_search">
                    <input type="search" placeholder="想带宝宝去哪？" name="q" {% if queryword %} value={{queryword}}{%endif%} class="serch-input" style="color: black;">
                    <button type="submit" style="background-color:#1eb6c1 ">
                        <i class="fa fa-search" style="color: #fff;"></i>
                    </button>
                </form>
            </div>
            <!-- /INLINE SEARCH -->
        </div>

    </section>

    <!-- /SLIDER -->
    <section class="body-section page-header-xs main_section">
        <div class="ctr container">			
				 <!-- page tabs -->
        
            <ul class="phb page-header-tabs list-inline margin-bottom-0 margin-top-70" id="phb">

                <!--<li class="active"><a href="portfolio-masonry-3-columns.html">With Gutter</a></li>-->
                <!-- Version 2.0 -->
                
                <li class="cgy" id="select1" onclick="getschool();"><a href="javascript:;" >学校</a><div class="linea"></div></li>
                <li class="cgy" id="select2" ><a href="javascript:;">游学</a><div class="linea" style="background-color: #fff;"></li>
                <li class="cgy" id="select3" onclick="gettournote();"><a href="javascript:;">游记攻略</a><div class="linea"></li>
                <li class="cgy" id="select4" onclick="gettourquestion();"><a href="javascript:;">问答</a><div class="linea"></li> 

               <!-- Version 1.0  
               <li class="cgy"><a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{val.id}}" >学校</a><div class="linea"></div></li>
               <li class="cgy"><a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{val.id}}">游学</a><div class="linea" style="background-color: #fff;"></li>
               <li class="cgy"><a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{val.id}}">游记攻略</a><div class="linea"></li>
               <li class="cgy"><a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{val.id}}">问答</a><div class="linea"></li>
               --> 



               <!--  <li  class="active" style="width: 226px;height: 85px;margin-right:-6px;padding:0px;background-color: pink;text-align: center;font-size: 28px;"><a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{val.id}}">游学</a></li>
               <li style="width: 226px;height: 85px;margin-right:-6px;padding:0px;background-color: red;text-align: center;font-size: 28px;"><a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{val.id}}">游记攻略</a></li>
               <li  style="width: 226px;height: 85px;margin-right:-6px;padding:0px;background-color: grey;text-align: center;font-size: 28px;"><a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{val.id}}">问答</a></li> -->
            </ul>
      
            <!-- /page tabs -->

            <div class="school" id="page1">
				<!-- 学校 -->

            </div>

            <div class="strategy" id="page3">
				<!-- 游记攻略 -->
				
			</div>
			
			<div class="qsn-awr" id="page4">
				<!-- 问答 -->
			</div>
           
            <div class="study-tour" id="page2">
            <!-- 分类信息
            {%if sort%}
            {%if sort.types|length ==1%}
            <ul class="nav nav-tabs">
                {%for val in sort.types%}
                <li class="{%if sortid == val.enable%}active{%endif%}"><a href="search{{http.config('view.file_ext')}}?value={{cate.id}}-{{order}}-{{group_id}}-{{val.enable}}" >{{val.name}}</a></li>
                {%endfor%}
            
            </ul>
            {%endif%} -->
            <!-- <div class="tct tab-content table-bordered" style=""> -->
            
            <div class="tct tab-content">
                <table class="table table  m-b-none" style="margin-top: -1px">
                    <tbody>
                        {% set typenum = 1%}
                        {%for val in typevar%}
                        {%if val.search > 1%}
                        <!-- <tr {% if typenum > 3 %} class="type_tr_m"  style="display:none"{%endif%} > -->
                        <tr  class="type_tr_m"  >
                            <td class="the-td">
                                {{val.option.title}}:
                            </td>
                            <td>
                                {%if 0 == nsobj[val.option.identifier] or null == nsobj[val.option.identifier]%}
                                <span class="btn btn-danger btn-xs relative">全部</span>
                                {%else%}
                                <a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{cate.id}}-{{order}}-{{group_id}}-{{sortid}}-{{0|sort_url(val.option.identifier,typevar,nsobj)}}" class="btn btn-clean btn-xs relative" >全部</a>
                                {%endif%}

                                {%for v in val.rules %}
                                {%if v.id|sort_act(nsobj[val.option.identifier])%}
                                <span class="btn btn-danger btn-xs relative" >{{v.name}}{{val.option.unit}}</span>
                                {%else%}
                                <a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{cate.id}}-{{order}}-{{group_id}}-{{sortid}}-{{v.id|sort_url(val.option.identifier,typevar,nsobj)}}" class="btn btn-clean btn-xs relative" >{{v.name}}{{val.option.unit}}</a>
                                {%endif%}
                                {%endfor%}
                                <!--子栏目-->
                                {%for v in val.rules %}
                                {%if v.id|sort_act(nsobj[val.option.identifier])%}
                                    {% if v.children%}
                                        <div class="subtsm" style="border: 0px;">
                                            {%if v.id == nsobj[val.option.identifier] %}
                                            <span class="btn btn-danger btn-xs relative">全部</span>
                                            {%else%}
                                            <a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{cate.id}}-{{order}}-{{group_id}}-{{sortid}}-{{v.id|sort_url(val.option.identifier,typevar,nsobj)}}" class="btn btn-clean btn-xs relative" >全部</a>
                                            {%endif%}

                                            {% for v_ in v.children %}  
                                            {%if v_.id|sort_act(nsobj[val.option.identifier])%}
                                            <span class="btn btn-danger btn-xs relative" >{{v_.name}}{{val.option.unit}}</span>
                                            {%else%}
                                            <a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{cate.id}}-{{order}}-{{group_id}}-{{sortid}}-{{v_.id|sort_url(val.option.identifier,typevar,nsobj)}}" class="btn btn-clean btn-xs relative">{{v_.name}}{{val.option.unit}}</a>
                                            {%endif%}
                                            {% endfor %}
                                        </div>
                                    {%endif%}
                                {%endif%}
                                {%endfor%}
                                <!--子栏目-->
                                {%for v in val.rules %}
                                {%if v.id|sort_act(nsobj[val.option.identifier])%}
                                {% if v.children%}

                                {% for v_ in v.children %}
                                {%if v_.id|sort_act(nsobj[val.option.identifier])%}
                                {% if v_.children%}
                                <div class="subtsm">
                                    {% for v__ in v_.children %}

                                    {%if v__.id|sort_act(nsobj[val.option.identifier])%}

                                    <span class="btn btn-danger btn-xs relative" >{{v__.name}}{{val.option.unit}}</span>
                                    {%else%}
                                    <a href="search{{http.config('view.file_ext')}}?q={{queryword}}&value={{cate.id}}-{{order}}-{{group_id}}-{{sortid}}-{{v__.id|sort_url(val.option.identifier,typevar,nsobj)}}" class="btn btn-clean btn-xs relative" >{{v__.name}}{{val.option.unit}}</a>

                                    {%endif%}
                                    {%endfor%}
                                </div>
                                {%endif%}
                                {%endif%}
                                {% endfor %}

                                {%endif%}
                                {%endif%}
                                {%endfor%}
                            </td>

                        </tr>
                        {% set typenum = typenum+1%}
                        {%endif%}
                        {%endfor%}

                      {%endif%}
                    </tbody>
                </table>
                <!-- {% if typenum > 4%}
                <a href="javascript:;" class="center-block btn btn-xs btn-white type_tr_b1" style="border-top: 1px solid #cfd8e1; display: block"><span class="fa fa-chevron-down"></span></a>
                <a href="javascript:;" class="center-block btn btn-xs btn-white type_tr_b2" style="border-top: 1px solid #cfd8e1; display: none"><span class="fa fa-chevron-up"></span></a>
                {%endif%} -->
               <!--  </div> -->
              
                <!--/分类信息-->
                <!--正文信息-->
                <div class="row txtbd" >

                    <!-- LEFT -->
                    <div class="col-md-9 col-sm-9 left-part studytour_pagination1">                    
                            {% for val in list %}
                            {% set categoryname = val.category_id|get_cate %}
                             <!-- POST ITEM -->
                            <div class="bpm blog-post-item padding-bottom-0 margin-bottom-15 clearfix">
                                <!-- IMAGE -->
                                {% if val.cover_id>0 %}
                                <figure class="blog-item-small-image margin-bottom-0">
                                    <img class="img-responsive a-img" src="{{val.cover_id|get_pic('m=1,w=200,h=120')}}" alt="" >
                                </figure>
                                {% endif %}
                                <div class="bilt blog-item-small-content">
                                    <p> &nbsp;</p>
                                        <h2>
                                            <a  class="goPage" href="{{val.name|get_url(val.id)}}" target="_blank" title="{{val.title}}">{{val.title|truncate(30, true, "...")}} <span class="price-span">¥{{val.price|get_price('1')}}/人起</span></a>
                                        </h2>
                                    <p>{{val.description|truncate(90, true, "...")}}</p>
                                </div> <!--add-->
                            </div>
                            <!-- /POST ITEM -->     
                            {%endfor%}

                            {#
                           <!-- PAGINATION(分页) -->
                           <div class="text-left">
                               <!-- Pagination Default -->
                               {{pagination | safe}} 
                               <!-- /Pagination Default -->
                           </div>
                          <!-- /PAGINATION -->
                            #}
                        
                     	
                   		{% if currentPage < totalPages %}
                    	<div class="text-center load-more">
                            <a href="javascript:studytour_pagination(2)">加载更多</a>
                        </div>
                        {% else%}
                        <!--
                        <div class="text-center no-more">
                            <p>已无更多</p>
                        </div>-->
                        {% endif %}
                        

                </div>

                      
                </div>
                                  
            </div>             
        </div>
			
    </section>

    <!-- /PAGE HEADER -->

    <!-- PEANUT ROLL -->   
    <section class="peanut-roll" >
	</section>
    <!-- /PEANUT ROLL -->

    {% endblock %}

{% block script %}	
<script>

    function GetQueryString(name){
        var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if(r!=null){
            //console.log(r[2]);
            //console.log(decodeURI(r[2]));
            return  (decodeURI(r[2])); 
        }
        return '';
    }

    $(".cgy").on("click",function(){
        $(this).siblings().children("div").css("background-color","#896B63");
        $(this).children("div").css("background-color","#fff");
        var selectId = $(this).attr("id");
        var pId = selectId.split("select")[1];
       	for (var i = 1; i <= 4; i++) {
       		if(i!=pId){
       			$("#page"+i).css("display","none");
       		}
       	} 	
        $("#page"+pId).css("display","block");
    });
        
    $(".bpm").on("click",function(){
    	var a=$(this).find("a");
    	var hrf=a.attr("href")
    	window.open(hrf);
    });

    //学校页面
    function getschool(days=0) {
        var searchword = GetQueryString("q");

        
        getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m"><td class="the-td">国  家：</td><td><span class="btn btn-danger btn-xs relative">全部</span><a href="javascript:;" class="btn btn-clean btn-xs relative">中国</a><a href="javascript:;" class="btn btn-clean btn-xs relative">英国</a><a href="javascript:;" class="btn btn-clean btn-xs relative">法国</a><a href="javascript:;" class="btn btn-clean btn-xs relative">美国</a></td></tr><tr class="type_tr_m"><td class="the-td">学校类别：</td><td> <span class="btn btn-danger btn-xs relative">全部</span> <a href="javascript:;" class="btn btn-clean btn-xs relative">幼儿园</a><a href="javascript:;" class="btn btn-clean btn-xs relative">小学</a><a href="javascript:;" class="btn btn-clean btn-xs relative">中学</a><a href="javascript:;" class="btn btn-clean btn-xs relative">大学</a></td></tr><tr class="type_tr_m"><td class="the-td"">学校性质:</td><td><span class="btn btn-danger btn-xs relative">全部</span><a href="javascript:;" class="btn btn-clean btn-xs relative">私立</a><a href="javascript:;" class="btn btn-clean btn-xs relative">公立</a><a href="javascript:;" class="btn btn-clean btn-xs relative">综合</a></td></tr></tbody></table>'

         $.ajax({
            type:"get",
            url:"ajax/topic?q="+searchword+"&page=1&value=141-0-0-18-tourdest_0",
            success:function(dataResult){
                //console.log(dataResult);
                getHtml +='<div class="tourschool_pagination tspage1 ">'
                $.each(dataResult.data,function(k,v){
                    if(0==v.cover_url.length){
                        getHtml +='<a target="_blank" href="/p/'+v.id+'.html"><div class="strategy-content">'+
                                
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.description+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';  
                    }else{
                        getHtml +='<a target="_blank" href="/p/'+v.id+'.html"><div class="strategy-content">'+
                                '<img src='+v.cover_url+'>'+
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.description+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';     
                    }          
                });
                if(dataResult.currentPage < dataResult.totalPages){
                    getHtml +='<div class="text-center ts-load-more">' + '<a href="javascript:tourschool_pagination(2);">加载更多</a>'+'</div></div><div class="tournote_pagination tpage2 "></div>'
                }
                $(".school").html(getHtml);
            }
        })
    }

    function gettournote(days=0){
        var searchword = GetQueryString("q");
        var getHtml = "";
        if(days==7){
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettournote();" class="btn btn-clean btn-xs relative">全部</a>\
                        <span class="btn btn-danger btn-xs relative">最近7天</span>\
                        <a href="javascript:gettournote(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <a href="javascript:gettournote(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <a href="javascript:gettournote(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';
             //history.replaceState(" "," ","question?cid=124&day<=7");
        }else if(days==30){
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettournote();" class="btn btn-clean btn-xs relative">全部</a>\
                        <a href="javascript:gettournote(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <span class="btn btn-danger btn-xs relative">最近30天</span>\
                        <a href="javascript:gettournote(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <a href="javascript:gettournote(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';
              //history.replaceState(" "," ","question?cid=124&day<=30");
        }else if(days==180){
            getHtml = '<table class="table table  <m-b-none></m-b-none>" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettournote();" class="btn btn-clean btn-xs relative">全部</a>\
                        <a href="javascript:gettournote(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <a href="javascript:gettournote(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <span class="btn btn-danger btn-xs relative">6个月内</span>\
                        <a href="javascript:gettournote(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';
              //history.replaceState(" "," ","question?cid=124&day<=180");
        }else if(days==365){
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettournote();" class="btn btn-clean btn-xs relative">全部</a>\
                        <a href="javascript:gettournote(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <a href="javascript:gettournote(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <a href="javascript:gettournote(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <span class="btn btn-danger btn-xs relative">1年内</span>\
                        </td></tr></tbody></table>';
             //history.replaceState(" "," ","question?cid=124&day<365");
        }else{
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><span class="btn btn-danger btn-xs relative">全部</span>\
                        <a href="javascript:gettournote(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <a href="javascript:gettournote(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <a href="javascript:gettournote(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <a href="javascript:gettournote(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';  
            //history.replaceState(" "," ","question?cid=124&day=all");      
        }
            //'<tr class="type_tr_m"><td style="width: 70px;">所在版面：</td><td> <span class="btn btn-danger btn-xs relative">全部</span> <a href="javascript:;" class="btn btn-clean btn-xs relative">英伦半岛</a><a href="javascript:;" class="btn btn-clean btn-xs relative">旅行摄影</a><a href="javascript:;" class="btn btn-clean btn-xs relative">环游欧洲</a><a href="javascript:;" class="btn btn-clean btn-xs relative">美式风情</a></td></tr></tbody></table>';

         $.ajax({
            type:"get",
            url:"/ajax/question?cid=124&day="+days+"&q="+searchword,
            success:function(dataResult){
                //console.log(dataResult);
                getHtml +='<div class="tournote_pagination tpage1 ">'
                $.each(dataResult.data,function(k,v){
                	if(0==v.imgurl.length){
                		getHtml +='<a target="_blank" href="/mod/question/'+v.id+'.html"><div class="strategy-content">'+
                                
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.detailtext+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';  
                	}else{
                        getHtml +='<a target="_blank" href="/mod/question/'+v.id+'.html"><div class="strategy-content">'+
                                '<img src='+v.imgurl+'>'+
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.detailtext+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';     
                	}                  
                });
                if(dataResult.currentPage < dataResult.totalPages){
                    getHtml +='<div class="text-center tn-load-more">' + '<a href="javascript:tournote_pagination(2);">加载更多</a>'+'</div></div><div class="tournote_pagination tpage2 "></div>'
                }else{
                    //getHtml +='<div class="text-center no-more">'+'<p>已无更多</p>'+'</div></div>';
                }
                $(".strategy").html(getHtml);
            }
        })
    };

    function gettourquestion(days=0){
        var searchword = GetQueryString("q");
        //console.log(days);
        var getHtml = "";
        if(days==7){
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettourquestion();" class="btn btn-clean btn-xs relative">全部</a>\
                        <span class="btn btn-danger btn-xs relative">最近7天</span>\
                        <a href="javascript:gettourquestion(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <a href="javascript:gettourquestion(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <a href="javascript:gettourquestion(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';
            //history.replaceState(" "," ","question?cid=125&day=7");
        }else if(days==30){
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettourquestion();" class="btn btn-clean btn-xs relative">全部</a>\
                        <a href="javascript:gettourquestion(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <span class="btn btn-danger btn-xs relative">最近30天</span>\
                        <a href="javascript:gettourquestion(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <a href="javascript:gettourquestion(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';
            //history.replaceState(" "," ","question?cid=125&day=30");
        }else if(days==180){
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettourquestion();" class="btn btn-clean btn-xs relative">全部</a>\
                        <a href="javascript:gettourquestion(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <a href="javascript:gettourquestion(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <span class="btn btn-danger btn-xs relative">6个月内</span>\
                        <a href="javascript:gettourquestion(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';
            //history.replaceState(" "," ","question?cid=125&day=180");
        }else if(days==365){
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><a href="javascript:gettourquestion();" class="btn btn-clean btn-xs relative">全部</a>\
                        <a href="javascript:gettourquestion(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <a href="javascript:gettourquestion(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <a href="javascript:gettourquestion(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <span class="btn btn-danger btn-xs relative">1年内</span>\
                        </td></tr></tbody></table>';
            //history.replaceState(" "," ","question?cid=125&day=365");
        }else{
            getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m">\
                        <td class="the-td">发帖时间：</td>\
                        <td><span class="btn btn-danger btn-xs relative">全部</span>\
                        <a href="javascript:gettourquestion(7);" class="btn btn-clean btn-xs relative">最近7天</a>\
                        <a href="javascript:gettourquestion(30);" class="btn btn-clean btn-xs relative">最近30天</a>\
                        <a href="javascript:gettourquestion(180);" class="btn btn-clean btn-xs relative">6个月内</a>\
                        <a href="javascript:gettourquestion(365);" class="btn btn-clean btn-xs relative">1年内</a>\
                        </td></tr></tbody></table>';
            //history.replaceState(" "," ","question?cid=125&day=all");        
        }
        getHtml += '<div class="tourquestion_page1"></div><div class="tourquestion_page2"></div>';
        $(".qsn-awr").html(getHtml);
        $(".tourquestion_page1").css("width","904px");
        var pageHtml = '';
         $.ajax({
            type:"get",
            url:"/ajax/question?cid=125&day="+days+"&q="+searchword,
            success:function(dataResult){
                $.each(dataResult.data,function(k,v){
                    pageHtml +='<a target="_blank" href="/mod/question/'+v.id+'.html"><div class="showquestion">'+
                                '<ul class="blog-post-info list-inline padding-bottom-10" style="border: 0px;width:825px;">\
                                    <li>\
                                        <a href="javascript:;"><img src="/uc/index/avatar/uid/'+v.uid+'" style="width: 50px;height: 50px;border-radius: 50%;"></a>\
                                        <a href="javascript:;">\
                                            <span class="font-lato span_userName">'+v.username+'</span>\
                                        </a>\
                                        <span class="font-lato">提了一个问题</span>\
                                    </li>\
                                    <li>\
                                        <span class="font-lato"> · </span>\
                                    </li>\
                                    <li>\
                                        <span class="font-lato">'+ v.create_time +'</span>\
                                    </li>'
                    if (0==v.answer_count) {
                        pageHtml += '<li style="margin-left:5px;">\
                                        <div style="background-color: #1eb6c1;color: #fff;border-radius:3px;">&nbsp;待回答&nbsp;</div>\
                                    </li>'
                    }
                    pageHtml +='</ul>'+
                                '<p>'+
                                '&nbsp;'+
                                '</p>'+
                                '<h2 style="font-size:15px;margin-bottom:6px;"><a href="/mod/question/'+v.id+'" title="'+v.title+'">'+
                                    v.title +
                                '</a></h2>'+
                                '<p>'+
                                    v.detailtext+
                                '</p>'+
                                '<ul class="blog-post-info list-inline margin-top-10" style="border: 0px;width: 250px;margin-left:600px;">\
                                    <li>\
                                        <img src="static/assets/images/reply.png" style="width: 16px;height: 16px;margin-top:-4px;"" />\
                                        <span class="font-lato">'+ v.answer_count +' 个回答</span>\
                                    </li>\
                                    <li style="margin:0px 10px;">\
                                        <div style="width:2px;height:13px ;background-color: black;"></div>\
                                    </li>\
                                    <li>\
                                        <img src="static/assets/images/browse.png" style="width: 16px;height: 16px;margin-top:-4px;"/>\
                                        <span class="font-lato">'+ v.view +' 人浏览</span>\
                                    </li>\
                                </ul>'+
                                '</div></a>';  
                	
                	          
                });
                if(dataResult.currentPage < dataResult.totalPages){
                    pageHtml +='<div class="text-center tq-load-more">' + '<a href="javascript:tourquestion_pagination(2);">加载更多</a>'+'</div></div>';
                }else{
                    //getHtml +='<div class="text-center no-more">'+'<p>已无更多</p>'+'</div>';
                }
                $(".tourquestion_page1").html(pageHtml);
            }
        })
    }; 

    function studytour_pagination(page) {
        var searchword = GetQueryString("q");
        var value = GetQueryString("value");
        console.log(value)
        var pageHTML = "";
        //var url = window.location.href;
        //var para = url.split("?q=")[1];
        $.ajax({
            type:"get",
            //url:"/ajax/search?q="+para+"&page="+page,
            url:"/ajax/topic?q="+searchword+"&page="+page+"&value="+value,
            success:function(dataResult){     
                //console.log(dataResult);
                $.each(dataResult.data,function(k,v){
                    if(null==v.cover_url){
                        pageHTML +='<a target="_blank" href="/p/'+v.tid+'.html"><div class="strategy-content">'+
                                
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                        '<span class="price-span">'+
                                            v.price +
                                        '</span>'+
                                    '</h2>'+
                                    '<p>'+
                                        v.description+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';  
                    }else{
                        pageHTML +='<a target="_blank" href="/p/'+v.id+'.html"><div class="strategy-content">'+
                                '<img src='+v.cover_url+'>'+
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                        '<span class="price-span">￥'+
                                        v.price +
                                        '/人起</span>'+
                                    '</h2>'+

                                    '<p>'+
                                        v.description+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';     
                    }    
                });
               
                if(dataResult.currentPage < dataResult.totalPages){
                    var nextPage = page+1;
                    pageHTML +='<div class="text-center load-more">' + '<a href=javascript:studytour_pagination('+nextPage+')>加载更多</a>'+'</div>'
                }else{
                    //pageHTML +='<div class="text-center no-more">'+'<p>已无更多</p>'+'</div>';
                }
                $(".load-more").hide();
                //console.log(pageHTML);
                if(0<$(".studytour_pagination"+page).length){
                	$(".studytour_pagination"+page).html(pageHTML); 
                }else{
                	 //console.log("创建新一页");
                	 var lastPage =  page-1;
                	 $(".studytour_pagination"+lastPage).after("<div></div>");
                	 $(".studytour_pagination"+lastPage).next().addClass("col-md-9 col-sm-9 left-part studytour_pagination"+page);
                	 $(".studytour_pagination"+page).html(pageHTML);
                }
                //$(".pagination"+page).html(pageHTML); 
                
            }
        });
    }

    function tournote_pagination(page) {
        var pageHTML = "";
        var searchword = GetQueryString("q");
        var dayString=$(".strategy span").text();
        var day;
        switch(dayString){
        	case "全部":
        		day = 0;
        		break;
        	case "最近7天":
        		day = 7;
        		break;
    		case "最近30天":
	    		day = 30;
	    		break;
	    	case "6个月内":
        		day = 180;
        		break;
        	case "1年内":
        		day = 365;
        		break;
        	default:
        	    day = 0;
        }

        //console.log(day);
        $.ajax({
            type:"get",
            url:"/ajax/question?cid=124&day="+day+"&page="+page+"&q="+searchword,
            success:function(dataResult){
                //console.log(dataResult);           
                $.each(dataResult.data,function(k,v){
                    if(0==v.imgurl.length){
                		pageHTML +='<a target="_blank" href="/mod/question/'+v.id+'.html">'+'<div class="strategy-content">'+
                				'<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.detailtext+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';  
                	}else{
                        pageHTML +='<a target="_blank" href="/mod/question/'+v.id+'.html">'+'<div class="strategy-content">'+
                                '<img src='+v.imgurl+'>'+
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.detailtext+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';     
                	}
                       
                });
               
                if(dataResult.currentPage < dataResult.totalPages){
                    var nextPage = page+1;
                    pageHTML +='<div class="text-center  tn-load-more">' + '<a href=javascript:tournote_pagination('+nextPage+')>加载更多</a>'+'</div><div class="tournote_pagination tpage'+nextPage+'"><div><div class="tpage'+nextPage+'"></div>'
                }else{
                    //pageHTML +='<div class="text-center no-more">'+'<p>已无更多</p>'+'</div>';
                }
                $(".tn-load-more").hide();
                $(".tpage"+page).html(pageHTML);

            }
        });
    }

    function tourquestion_pagination(page) {
        var pageHtml = "";
        var searchword = GetQueryString("q");
        var dayString=$(".qsn-awr span").text();
        var day;
        switch(dayString){
        	case "全部":
        		day = 0;
        		break;
        	case "最近7天":
        		day = 7;
        		break;
    		case "最近30天":
	    		day = 30;
	    		break;
	    	case "6个月内":
        		day = 180;
        		break;
        	case "1年内":
        		day = 365;
        		break;
        	default:
        	    day = 0;
        }
        $.ajax({
            type:"get",
            url:"/ajax/question?cid=125&day="+day+"&page="+page+"&q="+searchword,
            success:function(dataResult){
                console.log(dataResult);       
                $.each(dataResult.data,function(k,v){
                    pageHtml +='<a target="_blank" href="/mod/question/'+v.id+'.html"><div class="showquestion">'+
                                '<ul class="blog-post-info list-inline padding-bottom-10" style="border: 0px;width:825px;">\
                                    <li>\
                                        <a href="javascript:;"><img src="/uc/index/avatar/uid/'+v.uid+'" style="width: 50px;height: 50px;border-radius: 50%;"></a>\
                                        <a href="javascript:;">\
                                            <span class="font-lato span_userName">'+v.username+'</span>\
                                        </a>\
                                        <span class="font-lato">提了一个问题</span>\
                                    </li>\
                                    <li>\
                                        <span class="font-lato"> · </span>\
                                    </li>\
                                    <li>\
                                        <span class="font-lato">'+ v.create_time +'</span>\
                                    </li>'
                    if (0==v.answer_count) {
                        pageHtml += '<li style="margin-left:5px;">\
                                        <div style="background-color: #1eb6c1;color: #fff;border-radius:3px;">&nbsp;待回答&nbsp;</div>\
                                    </li>'
                    }
                    pageHtml +='</ul>'+
                                '<p>'+
                                '&nbsp;'+
                                '</p>'+
                                '<h2 style="font-size:15px;margin-bottom:6px;"><a href="/mod/question/'+v.id+'" title="'+v.title+'">'+
                                    v.title +
                                '</a></h2>'+
                                '<p>'+
                                    v.detailtext+
                                '</p>'+
                                '<ul class="blog-post-info list-inline margin-top-10" style="border: 0px;width: 250px;margin-left:600px;">\
                                    <li>\
                                        <img src="static/assets/images/reply.png" style="width: 16px;height: 16px;margin-top:-4px;"" />\
                                        <span class="font-lato">'+ v.answer_count +' 个回答</span>\
                                    </li>\
                                    <li style="margin:0px 10px;">\
                                        <div style="width:2px;height:13px ;background-color: black;"></div>\
                                    </li>\
                                    <li>\
                                        <img src="static/assets/images/browse.png" style="width: 16px;height: 16px;margin-top:-4px;"/>\
                                        <span class="font-lato">'+ v.view +' 人浏览</span>\
                                    </li>\
                                </ul>'+
                                '</div></a>';   
                });
               
                if(dataResult.currentPage < dataResult.totalPages){
                    var nextPage = page+1;
                    pageHTML +='<div class="text-center tq-load-more">' + '<a href=javascript:tourquestion_pagination('+nextPage+')>加载更多</a>'+'</div>'

                    var nextPage = page +1 ;
                    $(".tourquestion_page"+page).after("<div></div>");
                    $(".tourquestion_page"+page).next().addClass(".tourquestion_page"+nextPage);
                }else{
                    //pageHTML +='<div class="text-center no-more">'+'<p>已无更多</p>'+'</div>';
                }
                $(".tq-load-more").hide();
                $(".tourquestion_page"+page).html(pageHtml);
            }
        });
    }

    function tourschool_pagination(page) {
        console.log("asad");
        var getHtml = '';
        var searchword = GetQueryString("q");

         $.ajax({
            type:"get",
            url:"ajax/topic?q="+searchword+"&page="+page+"&value=141-0-0-18-tourdest_0",

            success:function(dataResult){
                console.log(dataResult);
               
                $.each(dataResult.data,function(k,v){
                    if(0==v.cover_url.length){
                        getHtml +='<a target="_blank" href="/p/'+v.id+'.html"><div class="strategy-content">'+
                                
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.description+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';  
                    }else{
                        getHtml +='<a target="_blank" href="/p/'+v.id+'.html"><div class="strategy-content">'+
                                '<img src='+v.cover_url+'>'+
                                '<div class="strategy-txt"> '+
                                    '<p>'+
                                    '&nbsp;'+
                                    '</p>'+
                                    '<h2>'+
                                        v.title +
                                    '</h2>'+
                                    '<p>'+
                                        v.description+
                                    '</p>'+
                                '</div>'+
                                '</div></a>';     
                    }          
                });
                if(dataResult.currentPage < dataResult.totalPages){
                    var nextPage = page +1 ;
                    getHtml +='<div class="text-center ts-load-more">' + '<a href="javascript:tourschool_pagination('+nextPage+');">加载更多</a>'+'</div>';
                    $(".tspage"+page).after("<div></div>");
                    $(".tourschool_pagination.tspage"+page).next().addClass("tourschool_pagination tspage"+nextPage);

                }

               
                $(".ts-load-more").hide();
                $(".tspage"+page).html(getHtml);
            }
        })
        
    }

    $("#select100").on("click",function(){
    	var getHtml = "";
    	getHtml = '<table class="table table  m-b-none" style="margin:10px 0px;"><tbody><tr class="type_tr_m"><td class="the-td">国  家：</td><td><span class="btn btn-danger btn-xs relative">全部</span><a href="javascript:;" class="btn btn-clean btn-xs relative">中国</a><a href="javascript:;" class="btn btn-clean btn-xs relative">英国</a><a href="javascript:;" class="btn btn-clean btn-xs relative">法国</a><a href="javascript:;" class="btn btn-clean btn-xs relative">美国</a></td></tr><tr class="type_tr_m"><td style="width: 70px;">学校类别：</td><td> <span class="btn btn-danger btn-xs relative">全部</span> <a href="javascript:;" class="btn btn-clean btn-xs relative">幼儿园</a><a href="javascript:;" class="btn btn-clean btn-xs relative">小学</a><a href="javascript:;" class="btn btn-clean btn-xs relative">中学</a><a href="javascript:;" class="btn btn-clean btn-xs relative">大学</a></td></tr><tr class="type_tr_m"><td style="width: 80px;">学校性质:</td><td><span class="btn btn-danger btn-xs relative">全部</span><a href="javascript:;" class="btn btn-clean btn-xs relative">私立</a><a href="javascript:;" class="btn btn-clean btn-xs relative">公立</a><a href="javascript:;" class="btn btn-clean btn-xs relative">综合</a></td></tr></tbody></table>'

    	 $.ajax({
        	type:"get",
        	url:"/ajax/question",
        	success:function(dataResult){
        		$.each(dataResult,function(k,v){
        			var detail_title = v.title;
        			var detail = v.detail.split("</p><p>");
        			var detail_img = detail[0].split("<p>")[1].split("<br>")[0];
        			var detail_txt = detail[1] + detail[2] + detail[3];
        		
        			getHtml +='<div class="strategy-content">'+
        						detail_img+
        						'<div class="strategy-txt"> '+
        							'<p>'+
        							'&nbsp;'+
        							'</p>'+
        							'<h2>'+
        								detail_title +
        							'</h2>'+
        							'<p>'+
        								detail_txt+
        							'</p>'+
        						'</div>'+
        						
        					 '</div>';        			
        		});
        		getHtml +='<div class="text-center" style="margin-top: 20px;margin-bottom: 20px;">' + '<a href="javascript:;" style="text-decoration-color: #8a8e9f;font-size: 18;">加载更多</a>'+'</div>'
        		$(".school").html(getHtml);
        	}
        })
    });


</script>
{% endblock %}
